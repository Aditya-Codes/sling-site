
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML>
  <HEAD>
    <TITLE>Apache Sling - Groovy Support</TITLE>
    <LINK rel="stylesheet" href="http://sling.apache.org/site/media.data/site.css" type="text/css" media="all">
    <LINK rel="icon" href="http://sling.apache.org/site/media.data/favicon.ico">
    <META http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </HEAD>
  <BODY><div class="siteconversion">This is an old version of the Sling website, see the <a href="http://sling.apache.org/site-conversion.html">site conversion page</a> for more info. The migrated but not yet edited version of this page is at <a href='/old-stuff/scriptengineintegration/groovy-support.html'>/old-stuff/scriptengineintegration/groovy-support.html</a></div>
    <DIV class="title">
      <DIV class="logo">
        <A href="http://sling.apache.org/site/index.html">
          <IMG border="0" alt="Apache Sling" src="http://sling.apache.org/site/media.data/logo.png">
        </A>
      </DIV>
      <DIV class="header">
        <A href="http://www.apache.org/">
          <IMG border="0" alt="Apache" src="http://sling.apache.org/site/media.data/apache.png">
        </A>
      </DIV>
    </DIV>
    <DIV class="menu">
<P><B>Documentation</B><BR class="atl-forced-newline">
<A href="getting-started.html" title="Getting Started">Getting Started</A><BR class="atl-forced-newline">
<A href="the-sling-engine.html" title="The Sling Engine">The Sling Engine</A><BR class="atl-forced-newline">
<A href="development.html" title="Development">Development</A><BR class="atl-forced-newline">
<A href="bundles.html" title="Bundles">Bundles</A><BR class="atl-forced-newline">
<A href="tutorials-how-tos.html" title="Tutorials & How-Tos">Tutorials &amp; How&#45;Tos</A><BR class="atl-forced-newline">
<A href="configuration.html" title="Configuration">Configuration</A><BR class="atl-forced-newline">
<A href="http://sling.apache.org/apidocs/sling6/index.html" class="external-link" rel="nofollow">API docs</A><BR class="atl-forced-newline">
<A href="http://s.apache.org/sling.wiki" class="external-link" rel="nofollow">Wiki</A><BR class="atl-forced-newline">
<A href="http://s.apache.org/sling.faq" class="external-link" rel="nofollow">FAQ</A><BR class="atl-forced-newline"></P>

<P><B>Project info</B><BR class="atl-forced-newline">
<A href="http://sling.apache.org/site/downloads.cgi" class="external-link" rel="nofollow">Downloads</A><BR class="atl-forced-newline">
<A href="http://www.apache.org/licenses/" class="external-link" rel="nofollow">License</A><BR class="atl-forced-newline">
<A href="contributing.html" title="Contributing">Contributing</A><BR class="atl-forced-newline">
<A href="news.html" title="News">News</A><BR class="atl-forced-newline">
<A href="links.html" title="Links">Links</A><BR class="atl-forced-newline">
<A href="project-information.html" title="Project Information">Project Information</A><BR class="atl-forced-newline">
<A href="https://issues.apache.org/jira/browse/SLING" class="external-link" rel="nofollow">Issue Tracker</A><BR class="atl-forced-newline">
<A href="http://svn.apache.org/viewvc/sling/trunk" class="external-link" rel="nofollow">Browse Source Repository</A><BR class="atl-forced-newline">
<A href="security.html" title="Security">Security</A><BR class="atl-forced-newline"></P>

<P><B>Sponsorship</B><BR class="atl-forced-newline">
<A href="http://www.apache.org/foundation/thanks.html" class="external-link" rel="nofollow">Thanks</A><BR class="atl-forced-newline">
<A href="http://www.apache.org/foundation/sponsorship.html" class="external-link" rel="nofollow">Become a Sponsor</A><BR>
<A href="http://www.apache.org/foundation/buy_stuff.html" class="external-link" rel="nofollow">Buy Stuff</A></P>


  <IFRAME src="http://www.apache.org/ads/button.html" style="border-width:0; float: left" frameborder="0" scrolling="no" width="135" height="135"></IFRAME>
  <P style="height: 135px"></P>
    </DIV>
    <DIV class="main">
        <DIV class="breadcrump" style="font-size: 80%;">
<A href="apache-sling.html" title="Apache Sling Website">Apache Sling Website</A>&nbsp;&gt;&nbsp;<A href="apache-sling.html" title="Apache Sling">Apache Sling</A>&nbsp;&gt;&nbsp;<A href="old-stuff.html" title="Old Stuff">Old Stuff</A>&nbsp;&gt;&nbsp;<A href="scriptengineintegration.html" title="ScriptEngineIntegration">ScriptEngineIntegration</A>&nbsp;&gt;&nbsp;<A href="" title="Groovy Support">Groovy Support</A>
        </DIV>


<P>After meeting Paul King of the Groovy Team at Apache Con US 08 in New Orleans, I set out to take a stab at SLING-315 again to add Groovy support to Sling. It turned out, that the current Groovy 1.6 branch already contains the required setup to build the <TT>groovy-all.jar</TT> as an OSGi Bundle, which is directly usable with Sling by just installing that bundle.</P>

<P>Currently the Groovy team is working hard towards the 1.6 release and many things are in flux, which is really great.</P>

<P>So, on 11. Dec. 2008 Paul King of the Groovy Team has deployed a <A href="http://snapshots.repository.codehaus.org/org/codehaus/groovy/groovy-all/1.6-RC-1-SNAPSHOT/groovy-all-1.6-RC-1-20081211.113737-1.jar" class="external-link" rel="nofollow">first RC1 Snapshot of Groovy 1.6</A> which contains all the required OSGi bundle manifest headers as well das the JSR-233 <TT>ScriptEngine</TT> to use the <TT>groovy-all.jar</TT> unmodified with Sling. So just go ahead, grab the Groovy-All 1.6 RC 1 SNAPSHOT deploy it into your Sling instance and enjoy the fun of Groovy.</P>

<P>If you want to be on verge of development, you might want to go for Groovy 1.7: The second SNAPSHOT of beta-1 also contains the required headers and classes and may as well be used unmodified in Sling. You may download it here: <TT><A href="http://snapshots.repository.codehaus.org/org/codehaus/groovy/groovy-all/1.7-beta-1-SNAPSHOT/groovy-all-1.7-beta-1-20081210.120632-2.jar" class="external-link" rel="nofollow">groovy-all-1.7-beta-1-20081210.120632-2.jar</A></TT>.</P>


<P>To deploy the bundle go to the Bundles page, for example at <A href="http://localhost:8888/system/console/bundles" class="external-link" rel="nofollow">http://localhost:8888/system/console/bundles</A> of the Apache Felix Web Console select the bundle file to upload, check the <EM>Start</EM> check box and click <EM>Install or Update</EM> button.</P>

<P>You may check, whether the Groovy ScriptEngine has been &quot;accepted&quot; by Sling, by going to the Script Engines page of the Apache Felix Web Console. You should see the entry for Groovy there, somthing like this:</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>Groovy Scripting Engine, 2.0
  Language      Groovy,
  Extensions    groovy
  MIME Types    application/x-groovy
  Names         groovy, Groovy
</PRE>
</DIV></DIV>


<H2><A name="GroovySupport-Testing"></A>Testing</H2>

<P>To test create a simple Groovy script, for example</P>

<DIV class="code panel" style="border-width: 1px;"><DIV class="codeContent panelContent">
<PRE class="code-java">
response.setContentType(<SPAN class="code-quote">&quot;text/plain&quot;</SPAN>);
response.setCharacterEncoding(<SPAN class="code-quote">&quot;UTF-8&quot;</SPAN>);

println <SPAN class="code-quote">&quot;Hello World !&quot;</SPAN>
println <SPAN class="code-quote">&quot;This is Groovy Speaking&quot;</SPAN>
println <SPAN class="code-quote">&quot;You requested the Resource ${resource} (yes, <SPAN class="code-keyword">this</SPAN> is a GString)&quot;</SPAN>
</PRE>
</DIV></DIV>

<P>and upload it to the repository as <TT>/apps/nt/folder/GET.groovy</TT> using your favourite WebDAV client or use curl to upload the file (assuming Sling is running on localhost:8888) :</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>$ curl -u admin:admin -FGET.groovy=@GET.groovy -F../../nt/jcr:primaryType=sling:Folder http:host:8888/apps/nt/folder
</PRE>
</DIV></DIV>

<P>To test it create a <TT>/sample</TT> <TT>nt:Folder</TT> node using your favourite WebDAV client or use curl again:</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>$ curl -u admin:admin -Fjcr:primaryType=nt:folder http://localhost:8888/
</PRE>
</DIV></DIV>


<P>Finally, request the <TT>/sample</TT> node using your favourite Browser or use curl again:</P>

<DIV class="preformatted panel" style="border-width: 1px;"><DIV class="preformattedContent panelContent">
<PRE>$ curl http://localhost:8888/sample
Hello World !
This is Groovy Speaking
You requested Resource JcrNodeResource, type=nt:folder, path=/sample (yes, this is a GString)
</PRE>
</DIV></DIV>


<H2><A name="GroovySupport-References"></A>References</H2>

<UL>
	<LI><A href="https://issues.apache.org/jira/browse/SLING-315" class="external-link" rel="nofollow">SLING-315</A> &ndash; The initial Sling issue proposing the addition of a Groovy ScriptEngine to Sling.</LI>
	<LI><A href="http://markmail.org/message/7sqscr5y2mbk6jko" class="external-link" rel="nofollow">Groovy Support in Apache Sling</A> &ndash; A short thread on turning the Groovy <TT>groovy-all.jar</TT> into an OSGi Bundle.</LI>
	<LI><A href="http://markmail.org/message/47n2ow2jlo553jvk" class="external-link" rel="nofollow">Groovy in Apache Sling</A> &ndash; Thread on adding the <TT>DynamicImport-Package</TT> header to the Groovy bundle manifest.</LI>
</UL>

        <DIV class="timestamp" style="margin-top: 30px; font-size: 80%; text-align: right;">
Last modified by fmeschbe on 2008-12-12 02:11:51.0
        </DIV>
        <DIV class="trademarkFooter">
Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
        </DIV>
    </DIV>
  </BODY>
</HTML>

